language: go
go:
- 1.11
env:
  global:
  - GIT_COMMITTER_NAME="Matsutanbot@Travis"
  - GIT_COMMITTER_EMAIL="matsuyuki.eca@gmail.com"
  - GIT_AUTHOR_NAME="Matsutanbot@Travis"
  - GIT_AUTHOR_EMAIL="matsuyuki.eca@gmail.com"
  - secure: "DC1MDBhj62hPEJvXEExvMroFMW31dG428ct/KSiQhrpz3mm7gwLYPHWq4UrqxROe1cRcqnTXmTVTKuI2u4hqHTY98D7DeYDmWpdGouvJneycVCUqt+2foyCWwTdcrvOpr8FDaJIe3CQhoBlLJRzvmqilYk0f84k2RiwcWez0CuIai0vatFL2YiNwmvf0f0IkXi3phZ++AXC37soHuZEWchKup5f2h+beVSScb2lWdxJVPGl3UYcgnUPOd9jb9kBmN9fdtChFieJEGTF32tP9+xmKz0iH09PPIZ1Wb7Dfuj2iZ5wUTaJ0j37Rwibjyz86dktMTsVF04IQ7zEKjkXLwxwMs+Cp5a+9bs/YBFH9UTAbeXgio18/QsQNt4HstgGxCq+pBN3af3bgBCxxxW41VGLLiSoSHqCGC2gVzkdWrtUz5zSq7ppPuZ03/9ezGWkVsMHUHzi8LQAhz+YepY+o+wrXrCxaPf5NPwP2gwPhnhvwiRUOiwsXs9RwD0TYqeCHvqPMFdQ6/UjuaiKFSZzqXAEnKp3ZuuztzCllwfB43QJcBd3hc2av7gM5A9XTxmVBXDl7VETGscV3QKQwtmilT/k7aHYm8PhMV5HYPvm1AuW3DxwjoO/a91U/yRgiPWnObbb/dUUK7ln67iKohLC9x366c5zmEIUdeQqOhoUrY6I="
install:
  - mkdir ~/src
  - pushd ~/src
  - git clone https://github.com/gohugoio/hugo.git
  - pushd ~/src/hugo
  - go install --tags extended
  - popd
  - popd
script:
- git checkout -b gh-pages
- git rm -rf hugo/public
- git commit -m "temporal remove public"
- '[ $GH_TOKEN ] && git subtree add --prefix=hugo/public https://$GH_TOKEN@github.com/matsuyuki-a/rmn-web.net.git
  gh-pages --squash >& /dev/null'
- cd hugo
- echo -e "\033[0;32mDeploying updates to GitHub...\033[0m"
- hugo -t hugo-multi-bootswatch
- cd public
- git add -A
- msg="rebuilding site `date`"
- git commit -m "$msg" || echo "(nothing to commit)"
- cd ../..
- '[ $GH_TOKEN ] && git subtree push --prefix=hugo/public https://$GH_TOKEN@github.com/matsuyuki-a/rmn-web.net.git
  gh-pages'
after_success:
- echo "OK"
notifications:
  slack:
    secure: q/rTirB3DGXQLMkjIrTqTkzJGjcb3m+QWoSPAC3uupRnJ5Vfh/aBM/nWVpPrXKnTMJMNXlWgth7oBt57u4tBtbpbaB8VBLAUVzH7AjHMYpC+zxePSrSq6bWcJq52xtPA22BqQIWkTV4PdhxoW8CsSBs4++T3+0lZsr02Q24vJBpvSVTwLPFSRdfWBoT9yt2bOIvw85PRBiWWXnutYvFnC/4RNfCa9PffOuecS6b1ElxPHEKfRV1SL/7m7rgEjw0OGZQnhb1hhDelbcrzH9Alj4GAcGjRZscINxUhstBQOOON37MFOBFKQBNvkE9XHjH/3Bmp0rpJHBjGdZiCXUo437CkxGIw+X7t2Tepp0aYnQ5+NKTlcXkgQk97qhvK5lC9C0g4Co++ui6hw1GZcXYyYovmZEX43XgWkoTCfA4eO1t/fURVF+4H37SKEXDyz45gMMlQRI4fAYIvI5U+QbTeGjq+x2ZlLsdgirl6wFCLIFyXT/gPUoON0/jjtHcxWaCV/gxPX0wuqNtKxDl3AhTq+gHxchjXEmUQ88kQiiKUovYjj4FQhUPEEPr+uMvnDbPFjtI/8klCeVmUnQvJcmCODr6wY6emNY/uVagFn2b4GGZ6GgYrq6OMvVeQjuxFB7HtXUy6SFnW41hTtdzdusPddnvLFnU28viK6ppwHrvFP68=
